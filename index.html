<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>QuoteFlow - Mobile Business App</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-card: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #34495e;
            --text-muted: #7f8c8d;
            --border-color: #e0e0e0;
            --shadow-light: rgba(0,0,0,0.1);
            --shadow-medium: rgba(0,0,0,0.15);
            --overlay: rgba(0,0,0,0.5);
            --theme-primary: #3498db;
            --theme-secondary: #2980b9;
            --theme-gradient: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            --theme-light: rgba(52, 152, 219, 0.1);
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --medicine: #9b59b6;
            --medicine-light: rgba(155, 89, 182, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-card: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #ecf0f1;
            --text-muted: #bdc3c7;
            --border-color: #34495e;
            --shadow-light: rgba(0,0,0,0.3);
            --shadow-medium: rgba(0,0,0,0.4);
            --overlay: rgba(0,0,0,0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            height: 100vh;
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        /* Header */
        .mobile-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
            box-shadow: 0 2px 20px var(--shadow-light);
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            min-height: 70px;
        }

        .app-branding {
            flex: 1;
        }

        .app-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--theme-primary);
            cursor: pointer;
            margin-bottom: 2px;
        }

        .app-slogan {
            font-size: 11px;
            color: var(--text-muted);
            cursor: pointer;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .header-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: var(--theme-light);
            color: var(--theme-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }

        .header-btn:active {
            background: var(--theme-primary);
            color: white;
            transform: scale(0.9);
        }

        /* Pages */
        .page {
            display: none;
            margin-top: 70px;
            padding: 16px;
            min-height: calc(100vh - 150px);
        }

        .page.active {
            display: block;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: 0 4px 20px var(--shadow-light);
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .card-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background: var(--theme-light);
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--theme-primary);
            color: white;
            border-radius: 8px;
            font-size: 14px;
        }

        .card-content {
            padding: 20px;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 18px;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            font-size: 16px;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--theme-primary);
            box-shadow: 0 0 0 4px var(--theme-light);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }

        .form-select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 20px;
            padding-right: 50px;
            appearance: none;
        }

        /* Action Buttons */
        .action-btn {
            width: 100%;
            padding: 20px;
            border: none;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 16px 0;
            min-height: 60px;
        }

        .btn-primary {
            background: var(--theme-gradient);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #229954);
            color: white;
        }

        .btn-medicine {
            background: linear-gradient(135deg, var(--medicine), #8e44ad);
            color: white;
        }

        .action-btn:active {
            transform: scale(0.98);
        }

        /* Line Items */
        .line-items {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .line-item {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .line-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--theme-gradient);
            border-radius: 0 4px 4px 0;
        }

        .line-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .item-number {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            background: var(--theme-light);
            padding: 6px 12px;
            border-radius: 12px;
        }

        .remove-item {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: var(--danger);
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .item-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .total-display {
            background: var(--theme-light);
            border: 2px solid var(--theme-primary);
            color: var(--theme-primary);
            font-weight: 700;
            text-align: center;
            border-radius: 16px;
            padding: 18px;
            font-size: 18px;
            margin-top: 8px;
        }

        /* Totals Card */
        .totals-card {
            background: var(--theme-gradient);
            color: white;
            border-radius: 20px;
            padding: 24px;
            margin: 20px 0;
            box-shadow: 0 8px 30px var(--shadow-medium);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            font-size: 16px;
        }

        .total-row:last-child {
            margin-bottom: 0;
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 16px;
            font-size: 20px;
            font-weight: 700;
        }

        .tax-input {
            width: 80px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            font-size: 16px;
        }

        /* Medicine Cards */
        .medicine-card {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .medicine-header {
            background: var(--medicine-light);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .medicine-info {
            flex: 1;
        }

        .medicine-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .medicine-dosage {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 2px;
        }

        .medicine-instructions {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .medicine-actions {
            display: flex;
            gap: 8px;
        }

        .medicine-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .duplicate-medicine { background: #17a2b8; color: white; }
        .edit-medicine { background: var(--warning); color: white; }
        .delete-medicine { background: var(--danger); color: white; }

        .medicine-schedule {
            padding: 20px;
        }

        .schedule-item {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border: 1px solid var(--border-color);
        }

        .schedule-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .schedule-time {
            font-weight: 700;
            color: var(--text-primary);
            font-size: 16px;
        }

        .schedule-status {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .status-indicator {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--border-color);
        }

        .status-indicator.taken { background: var(--success); }
        .status-indicator.missed { background: var(--danger); }
        .status-indicator.pending { background: var(--warning); }

        .take-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            min-width: 70px;
        }

        .take-btn.taken { background: var(--success); color: white; }
        .take-btn.pending { background: var(--theme-primary); color: white; }
        .take-btn.missed { background: var(--danger); color: white; }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 20px 16px;
            border-radius: 16px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .stat-number {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 600;
        }

        .stat-taken .stat-number { color: var(--success); }
        .stat-pending .stat-number { color: var(--warning); }
        .stat-missed .stat-number { color: var(--danger); }

        /* Time Selection */
        .time-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .time-input {
            padding: 16px 12px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            background: var(--bg-primary);
            color: var(--text-primary);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-input.active {
            background: var(--medicine);
            color: white;
            border-color: var(--medicine);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top: 1px solid var(--border-color);
            z-index: 1000;
            box-shadow: 0 -4px 20px var(--shadow-light);
        }

        .nav-container {
            display: flex;
            height: 80px;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: none;
            color: var(--text-muted);
        }

        .nav-item.active {
            color: var(--theme-primary);
            background: var(--theme-light);
        }

        .nav-icon {
            font-size: 24px;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
        }

        /* FAB */
        .fab {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: var(--theme-gradient);
            color: white;
            border: none;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 8px 30px var(--shadow-medium);
            z-index: 999;
            transition: all 0.3s ease;
        }

        .fab:active {
            transform: scale(0.9);
        }

        /* Drawer */
        .drawer {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%;
            height: 100vh;
            background: var(--bg-card);
            z-index: 1500;
            transition: right 0.3s ease;
            overflow-y: auto;
        }

        .drawer.open {
            right: 0;
        }

        .drawer-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 70px;
        }

        .drawer-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .close-drawer {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .drawer-content {
            padding: 20px;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-card);
            z-index: 1600;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .modal.active {
            transform: translateY(0);
        }

        .modal-content {
            padding: 20px;
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay);
            z-index: 1400;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        /* Status message */
        .status-message {
            position: fixed;
            top: 90px;
            left: 20px;
            right: 20px;
            padding: 16px 20px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 2000;
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .status-message.show {
            transform: translateY(0);
            opacity: 1;
        }

        .status-message.success {
            background: var(--success);
            color: white;
        }

        .status-message.error {
            background: var(--danger);
            color: white;
        }
    </style>
</head>
<body data-theme="light">
    <!-- Header -->
    <div class="mobile-header">
        <div class="header-content">
            <div class="app-branding">
                <div class="app-title">QuoteFlow</div>
                <div class="app-slogan">Business & Medicine Tracker</div>
            </div>
            <div class="header-actions">
                <button class="header-btn" onclick="toggleSettings()">⚙️</button>
            </div>
        </div>
    </div>

    <!-- Quotation Page -->
    <div class="page active" id="quotationPage">
        <!-- Company Details -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon">🏢</div>
                    <span>Company Details</span>
                </div>
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">Company Name</label>
                    <input type="text" class="form-input" id="companyName" placeholder="Your Company Name">
                </div>
                <div class="form-group">
                    <label class="form-label">Address</label>
                    <textarea class="form-input form-textarea" id="companyAddress" placeholder="Your company address"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" id="companyPhone" placeholder="Phone number">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="companyEmail" placeholder="Email address">
                </div>
            </div>
        </div>

        <!-- Customer Details -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon">👤</div>
                    <span>Customer Details</span>
                </div>
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">Customer Name</label>
                    <input type="text" class="form-input" id="customerName" placeholder="Customer name">
                </div>
                <div class="form-group">
                    <label class="form-label">Address</label>
                    <textarea class="form-input form-textarea" id="customerAddress" placeholder="Customer address"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" id="customerPhone" placeholder="Customer phone">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="customerEmail" placeholder="Customer email">
                </div>
            </div>
        </div>

        <!-- Quotation Info -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon">📄</div>
                    <span>Quotation Information</span>
                </div>
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">Quotation Number</label>
                    <input type="text" class="form-input" id="quotationNumber" placeholder="Q-001">
                </div>
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" class="form-input" id="quotationDate">
                </div>
                <div class="form-group">
                    <label class="form-label">Valid Until</label>
                    <input type="date" class="form-input" id="validUntil">
                </div>
                <div class="form-group">
                    <label class="form-label">Currency</label>
                    <select class="form-input form-select" id="currency">
                        <option value="$">USD ($)</option>
                        <option value="€">EUR (€)</option>
                        <option value="£">GBP (£)</option>
                        <option value="¥">JPY (¥)</option>
                        <option value="RM">MYR (RM)</option>
                        <option value="₹">INR (₹)</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Line Items -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon">📦</div>
                    <span>Products & Services</span>
                </div>
            </div>
            <div class="card-content">
                <div class="line-items">
                    <div id="lineItemsContainer">
                        <div class="line-item">
                            <div class="line-item-header">
                                <span class="item-number">Item #1</span>
                                <button class="remove-item" onclick="removeLineItem(this)">×</button>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <input type="text" class="form-input item-description" placeholder="Product or service description">
                            </div>
                            <div class="item-row">
                                <div class="form-group">
                                    <label class="form-label">Quantity</label>
                                    <input type="number" class="form-input item-quantity" value="1" min="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Unit Price</label>
                                    <input type="number" class="form-input item-price" step="0.01" min="0" placeholder="0.00">
                                </div>
                            </div>
                            <div class="total-display item-total">$0.00</div>
                        </div>
                    </div>
                    <button type="button" class="action-btn btn-primary" onclick="addLineItem()">
                        <span>➕</span> Add Item
                    </button>
                </div>

                <!-- Totals -->
                <div class="totals-card">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Tax Rate:</span>
                        <div>
                            <input type="number" class="tax-input" id="taxRate" value="0" min="0" max="100" step="0.1" placeholder="0">%
                        </div>
                    </div>
                    <div class="total-row">
                        <span>Tax Amount:</span>
                        <span id="taxAmount">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Total:</span>
                        <span id="grandTotal">$0.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon">📝</div>
                    <span>Terms & Notes</span>
                </div>
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">Terms & Conditions / Notes</label>
                    <textarea class="form-input form-textarea" id="notes" placeholder="Payment terms, delivery information, or any additional notes" rows="4"></textarea>
                </div>
            </div>
        </div>

        <!-- Generate Button -->
        <button type="button" class="action-btn btn-success" onclick="generateQuotation()">
            <span>📄</span> Generate Quotation
        </button>
    </div>

    <!-- Medicine Page -->
    <div class="page" id="medicinePage">
        <h2 class="text-center" style="margin-bottom: 24px; font-size: 24px; font-weight: 800;">💊 Medicine Tracker</h2>
        
        <!-- Stats -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <div class="card-icon" style="background: var(--medicine);">📊</div>
                    <span>Today's Overview</span>
                </div>
            </div>
            <div class="card-content">
                <div class="stats-grid">
                    <div class="stat-card stat-taken">
                        <div class="stat-number" id="todayTaken">0</div>
                        <div class="stat-label">Taken</div>
                    </div>
                    <div class="stat-card stat-pending">
                        <div class="stat-number" id="todayPending">0</div>
                        <div class="stat-label">Pending</div>
                    </div>
                    <div class="stat-card stat-missed">
                        <div class="stat-number" id="todayMissed">0</div>
                        <div class="stat-label">Missed</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Medicine Button -->
        <button type="button" class="action-btn btn-medicine" onclick="showAddMedicineModal()">
            <span>💊</span> Add Medicine
        </button>

        <!-- Medicine List -->
        <div id="medicineList"></div>
    </div>

    <!-- FAB -->
    <button class="fab" onclick="fabAction()" id="fabBtn">+</button>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-container">
            <button class="nav-item active" onclick="switchPage('quotation')">
                <div class="nav-icon">📄</div>
                <div class="nav-label">Quotes</div>
            </button>
            <button class="nav-item" onclick="switchPage('medicine')">
                <div class="nav-icon">💊</div>
                <div class="nav-label">Medicine</div>
            </button>
        </div>
    </div>

    <!-- Settings Drawer -->
    <div class="drawer" id="settingsDrawer">
        <div class="drawer-header">
            <div class="drawer-title">Settings</div>
            <button class="close-drawer" onclick="toggleSettings()">×</button>
        </div>
        <div class="drawer-content">
            <button class="action-btn btn-primary" onclick="exportData()">
                <span>📤</span> Export Data
            </button>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
            <button class="action-btn btn-primary" onclick="document.getElementById('importFile').click()">
                <span>📥</span> Import Data
            </button>
            <button class="action-btn" onclick="clearAllData()" style="background: var(--danger); color: white;">
                <span>🗑️</span> Clear All Data
            </button>
        </div>
    </div>

    <!-- Add Medicine Modal -->
    <div class="modal" id="addMedicineModal">
        <div class="drawer-header">
            <div class="drawer-title">Add Medicine</div>
            <button class="close-drawer" onclick="closeAddMedicineModal()">×</button>
        </div>
        <div class="modal-content">
            <div class="form-group">
                <label class="form-label">Medicine Name</label>
                <input type="text" class="form-input" id="medicineName" placeholder="e.g., Aspirin">
            </div>
            <div class="form-group">
                <label class="form-label">Dosage</label>
                <input type="text" class="form-input" id="medicineDosage" placeholder="e.g., 500mg">
            </div>
            <div class="form-group">
                <label class="form-label">Instructions</label>
                <input type="text" class="form-input" id="medicineInstructions" placeholder="e.g., After meals">
            </div>
            <div class="form-group">
                <label class="form-label">Daily Times (tap to select)</label>
                <div class="time-grid" id="timeSlots">
                    <button type="button" class="time-input" onclick="toggleTimeSlot(this, '06:00')">06:00</button>
                    <button type="button" class="time-input" onclick="toggleTimeSlot(this, '08:00')">08:00</button>
                    <button type="button" class="time-input" onclick="toggleTimeSlot(this, '12:00')">12:00</button>
                    <button type="button" class="time-input" onclick="toggleTimeSlot(this, '18:00')">18:00</button>
                    <button type="button" class="time-input" onclick="toggleTimeSlot(this, '22:00')">22:00</button>
                    <button type="button" class="time-input" onclick="addCustomTime()">+ Custom</button>
                </div>
            </div>
            <button type="button" class="action-btn btn-medicine" onclick="saveMedicine()">
                <span>💾</span> Save Medicine
            </button>
        </div>
    </div>

    <!-- Status Message -->
    <div class="status-message" id="statusMessage"></div>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="closeModals()"></div>

    <script>
        // App State - Simple and Clean
        let AppState = {
            medicines: [],
            medicineLog: [],
            selectedTimes: [],
            lineItemCount: 1,
            currentPage: 'quotation'
        };

        // Simple Storage Functions
        function saveData() {
            try {
                // Save all form data
                const data = {
                    // Company data
                    companyName: document.getElementById('companyName').value,
                    companyAddress: document.getElementById('companyAddress').value,
                    companyPhone: document.getElementById('companyPhone').value,
                    companyEmail: document.getElementById('companyEmail').value,

                    // Customer data
                    customerName: document.getElementById('customerName').value,
                    customerAddress: document.getElementById('customerAddress').value,
                    customerPhone: document.getElementById('customerPhone').value,
                    customerEmail: document.getElementById('customerEmail').value,

                    // Quotation data
                    quotationNumber: document.getElementById('quotationNumber').value,
                    quotationDate: document.getElementById('quotationDate').value,
                    validUntil: document.getElementById('validUntil').value,
                    currency: document.getElementById('currency').value,
                    notes: document.getElementById('notes').value,
                    taxRate: document.getElementById('taxRate').value,

                    // Line items
                    lineItems: [],

                    // Medicine data
                    medicines: AppState.medicines,
                    medicineLog: AppState.medicineLog,
                    currentPage: AppState.currentPage
                };

                // Save line items
                document.querySelectorAll('.line-item').forEach((item, index) => {
                    data.lineItems.push({
                        description: item.querySelector('.item-description').value,
                        quantity: item.querySelector('.item-quantity').value,
                        price: item.querySelector('.item-price').value
                    });
                });

                localStorage.setItem('quoteflow_data', JSON.stringify(data));
                console.log('Data saved successfully');
            } catch (error) {
                console.error('Save failed:', error);
            }
        }

        function loadData() {
            try {
                const saved = localStorage.getItem('quoteflow_data');
                if (!saved) return;

                const data = JSON.parse(saved);

                // Load company data
                if (data.companyName !== undefined) document.getElementById('companyName').value = data.companyName;
                if (data.companyAddress !== undefined) document.getElementById('companyAddress').value = data.companyAddress;
                if (data.companyPhone !== undefined) document.getElementById('companyPhone').value = data.companyPhone;
                if (data.companyEmail !== undefined) document.getElementById('companyEmail').value = data.companyEmail;

                // Load customer data
                if (data.customerName !== undefined) document.getElementById('customerName').value = data.customerName;
                if (data.customerAddress !== undefined) document.getElementById('customerAddress').value = data.customerAddress;
                if (data.customerPhone !== undefined) document.getElementById('customerPhone').value = data.customerPhone;
                if (data.customerEmail !== undefined) document.getElementById('customerEmail').value = data.customerEmail;

                // Load quotation data
                if (data.quotationNumber !== undefined) document.getElementById('quotationNumber').value = data.quotationNumber;
                if (data.quotationDate !== undefined) document.getElementById('quotationDate').value = data.quotationDate;
                if (data.validUntil !== undefined) document.getElementById('validUntil').value = data.validUntil;
                if (data.currency !== undefined) document.getElementById('currency').value = data.currency;
                if (data.notes !== undefined) document.getElementById('notes').value = data.notes;
                if (data.taxRate !== undefined) document.getElementById('taxRate').value = data.taxRate;

                // Load line items
                if (data.lineItems && data.lineItems.length > 0) {
                    const container = document.getElementById('lineItemsContainer');
                    container.innerHTML = '';
                    
                    data.lineItems.forEach((item, index) => {
                        addLineItemWithData(item, index + 1);
                    });
                    AppState.lineItemCount = data.lineItems.length;
                }

                // Load medicine data
                if (data.medicines) AppState.medicines = data.medicines;
                if (data.medicineLog) AppState.medicineLog = data.medicineLog;
                if (data.currentPage) AppState.currentPage = data.currentPage;

                updateGrandTotal();
                updateMedicineList();
                loadTodaysOverview();
                
                console.log('Data loaded successfully');
            } catch (error) {
                console.error('Load failed:', error);
            }
        }

        // Status Message
        function showStatus(message, type = 'success') {
            const status = document.getElementById('statusMessage');
            status.textContent = message;
            status.className = `status-message show ${type}`;
            setTimeout(() => {
                status.classList.remove('show');
            }, 3000);
        }

        // Page Management
        function switchPage(page) {
            AppState.currentPage = page;
            
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(page + 'Page').classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
            document.querySelector(`[onclick="switchPage('${page}')"]`).classList.add('active');
            
            updateFAB();
            saveData();
            
            if (page === 'medicine') {
                loadTodaysOverview();
                updateMedicineList();
            }
        }

        function updateFAB() {
            const fab = document.getElementById('fabBtn');
            fab.innerHTML = AppState.currentPage === 'quotation' ? '+' : '💊';
        }

        function fabAction() {
            if (AppState.currentPage === 'quotation') {
                addLineItem();
            } else {
                showAddMedicineModal();
            }
        }

        // Quotation Functions
        function addLineItem() {
            AppState.lineItemCount++;
            addLineItemWithData({description: '', quantity: 1, price: 0}, AppState.lineItemCount);
        }

        function addLineItemWithData(data, itemNumber) {
            const container = document.getElementById('lineItemsContainer');
            const newItem = document.createElement('div');
            newItem.className = 'line-item';
            newItem.innerHTML = `
                <div class="line-item-header">
                    <span class="item-number">Item #${itemNumber}</span>
                    <button class="remove-item" onclick="removeLineItem(this)">×</button>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-input item-description" placeholder="Product or service description" value="${data.description}">
                </div>
                <div class="item-row">
                    <div class="form-group">
                        <label class="form-label">Quantity</label>
                        <input type="number" class="form-input item-quantity" value="${data.quantity}" min="1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Unit Price</label>
                        <input type="number" class="form-input item-price" step="0.01" min="0" placeholder="0.00" value="${data.price}">
                    </div>
                </div>
                <div class="total-display item-total">$0.00</div>
            `;
            
            container.appendChild(newItem);
            
            // Add event listeners
            const quantityInput = newItem.querySelector('.item-quantity');
            const priceInput = newItem.querySelector('.item-price');
            
            [quantityInput, priceInput].forEach(input => {
                input.addEventListener('input', () => updateLineItemTotal(newItem));
            });
            
            updateLineItemTotal(newItem);
        }

        function removeLineItem(button) {
            button.closest('.line-item').remove();
            updateGrandTotal();
            saveData();
        }

        function updateLineItemTotal(lineItem) {
            const quantity = parseFloat(lineItem.querySelector('.item-quantity').value) || 0;
            const price = parseFloat(lineItem.querySelector('.item-price').value) || 0;
            const total = quantity * price;
            const currency = document.getElementById('currency').value || '$';
            
            lineItem.querySelector('.item-total').textContent = `${currency}${total.toFixed(2)}`;
            updateGrandTotal();
        }

        function updateGrandTotal() {
            const currency = document.getElementById('currency').value || '$';
            let subtotal = 0;
            
            document.querySelectorAll('.line-item').forEach(item => {
                const quantity = parseFloat(item.querySelector('.item-quantity').value) || 0;
                const price = parseFloat(item.querySelector('.item-price').value) || 0;
                subtotal += quantity * price;
            });
            
            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const taxAmount = subtotal * (taxRate / 100);
            const grandTotal = subtotal + taxAmount;
            
            document.getElementById('subtotal').textContent = `${currency}${subtotal.toFixed(2)}`;
            document.getElementById('taxAmount').textContent = `${currency}${taxAmount.toFixed(2)}`;
            document.getElementById('grandTotal').textContent = `${currency}${grandTotal.toFixed(2)}`;
        }

        function generateQuotation() {
            saveData();
            showStatus('Quotation generated successfully!');
        }

        // Medicine Functions
        function showAddMedicineModal() {
            AppState.selectedTimes = [];
            document.getElementById('medicineName').value = '';
            document.getElementById('medicineDosage').value = '';
            document.getElementById('medicineInstructions').value = '';
            
            // Reset time slots
            document.querySelectorAll('#timeSlots .time-input').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById('addMedicineModal').classList.add('active');
            document.getElementById('overlay').classList.add('active');
        }

        function closeAddMedicineModal() {
            document.getElementById('addMedicineModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        function toggleTimeSlot(button, time) {
            if (AppState.selectedTimes.includes(time)) {
                AppState.selectedTimes = AppState.selectedTimes.filter(t => t !== time);
                button.classList.remove('active');
            } else {
                AppState.selectedTimes.push(time);
                button.classList.add('active');
            }
        }

        function addCustomTime() {
            const time = prompt('Enter time (HH:MM format, e.g., 14:30):');
            if (time && /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(time)) {
                const timeSlots = document.getElementById('timeSlots');
                const customBtn = timeSlots.querySelector('button:last-child');
                
                const newBtn = document.createElement('button');
                newBtn.type = 'button';
                newBtn.className = 'time-input';
                newBtn.textContent = time;
                newBtn.onclick = () => toggleTimeSlot(newBtn, time);
                
                timeSlots.insertBefore(newBtn, customBtn);
                toggleTimeSlot(newBtn, time);
            }
        }

        function saveMedicine() {
            const name = document.getElementById('medicineName').value.trim();
            const dosage = document.getElementById('medicineDosage').value.trim();
            const instructions = document.getElementById('medicineInstructions').value.trim() || 'As needed';
            
            if (!name || !dosage || AppState.selectedTimes.length === 0) {
                showStatus('Please fill all fields and select at least one time', 'error');
                return;
            }
            
            const medicine = {
                id: Date.now(),
                name,
                dosage,
                instructions,
                times: AppState.selectedTimes,
                createdAt: new Date().toISOString()
            };
            
            AppState.medicines.push(medicine);
            createTodaysSchedule(medicine);
            updateMedicineList();
            loadTodaysOverview();
            saveData();
            
            closeAddMedicineModal();
            showStatus(`Medicine "${name}" added successfully!`);
        }

        function createTodaysSchedule(medicine) {
            const today = new Date().toDateString();
            medicine.times.forEach(time => {
                const logEntry = {
                    id: Date.now() + Math.random(),
                    medicineId: medicine.id,
                    medicineName: medicine.name,
                    dosage: medicine.dosage,
                    scheduledTime: time,
                    date: today,
                    status: 'pending',
                    actualTime: null
                };
                AppState.medicineLog.push(logEntry);
            });
        }

        function updateMedicineList() {
            const container = document.getElementById('medicineList');
            container.innerHTML = '';
            
            if (AppState.medicines.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-muted);">
                        <div style="font-size: 48px; margin-bottom: 16px;">💊</div>
                        <div style="font-size: 16px; margin-bottom: 8px;">No medicines added yet</div>
                        <div style="font-size: 14px;">Tap "Add Medicine" to get started</div>
                    </div>
                `;
                return;
            }
            
            const today = new Date().toDateString();
            
            AppState.medicines.forEach(medicine => {
                const medicineCard = document.createElement('div');
                medicineCard.className = 'medicine-card';
                
                const todaysSchedule = AppState.medicineLog.filter(log => 
                    log.medicineId === medicine.id && log.date === today
                );
                
                let scheduleHTML = '';
                todaysSchedule.forEach(log => {
                    const statusClass = log.status;
                    
                    scheduleHTML += `
                        <div class="schedule-item">
                            <div class="schedule-header">
                                <div class="schedule-time">${log.scheduledTime}</div>
                                <div class="schedule-status">
                                    <div class="status-indicator ${statusClass}"></div>
                                    ${log.status === 'pending' ? 
                                        `<button class="take-btn pending" onclick="markMedicineTaken(${log.id})">Take</button>` :
                                        log.status === 'taken' ? 
                                        `<span style="font-size: 12px; color: var(--success);">✓ ${log.actualTime || 'Taken'}</span>` :
                                        `<button class="take-btn missed" onclick="markMedicineTaken(${log.id})">Mark Taken</button>`
                                    }
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                medicineCard.innerHTML = `
                    <div class="medicine-header">
                        <div class="medicine-info">
                            <div class="medicine-name">${medicine.name}</div>
                            <div class="medicine-dosage">${medicine.dosage}</div>
                            <div class="medicine-instructions">${medicine.instructions}</div>
                        </div>
                        <div class="medicine-actions">
                            <button class="medicine-btn delete-medicine" onclick="deleteMedicine(${medicine.id})" title="Delete">🗑️</button>
                        </div>
                    </div>
                    <div class="medicine-schedule">
                        ${scheduleHTML}
                    </div>
                `;
                
                container.appendChild(medicineCard);
            });
        }

        function markMedicineTaken(logId) {
            const logEntry = AppState.medicineLog.find(log => log.id === logId);
            if (logEntry) {
                logEntry.status = 'taken';
                logEntry.actualTime = new Date().toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                updateMedicineList();
                loadTodaysOverview();
                saveData();
                showStatus(`${logEntry.medicineName} marked as taken!`);
            }
        }

        function deleteMedicine(medicineId) {
            const medicine = AppState.medicines.find(m => m.id === medicineId);
            if (medicine && confirm(`Delete "${medicine.name}"?`)) {
                AppState.medicines = AppState.medicines.filter(m => m.id !== medicineId);
                AppState.medicineLog = AppState.medicineLog.filter(log => log.medicineId !== medicineId);
                updateMedicineList();
                loadTodaysOverview();
                saveData();
                showStatus(`Medicine "${medicine.name}" deleted!`);
            }
        }

        function loadTodaysOverview() {
            const today = new Date().toDateString();
            const todaysLog = AppState.medicineLog.filter(log => log.date === today);
            
            const taken = todaysLog.filter(log => log.status === 'taken').length;
            const pending = todaysLog.filter(log => log.status === 'pending').length;
            const missed = todaysLog.filter(log => log.status === 'missed').length;
            
            document.getElementById('todayTaken').textContent = taken;
            document.getElementById('todayPending').textContent = pending;
            document.getElementById('todayMissed').textContent = missed;
        }

        // Settings Functions
        function toggleSettings() {
            const drawer = document.getElementById('settingsDrawer');
            const overlay = document.getElementById('overlay');
            const isOpen = drawer.classList.contains('open');
            
            if (isOpen) {
                drawer.classList.remove('open');
                overlay.classList.remove('active');
            } else {
                drawer.classList.add('open');
                overlay.classList.add('active');
            }
        }

        function closeModals() {
            document.getElementById('settingsDrawer').classList.remove('open');
            document.getElementById('addMedicineModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        function exportData() {
            try {
                saveData(); // Save current state first
                const data = localStorage.getItem('quoteflow_data');
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `quoteflow-backup-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                showStatus('Data exported successfully!');
            } catch (error) {
                showStatus('Export failed!', 'error');
            }
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = e.target.result;
                    localStorage.setItem('quoteflow_data', data);
                    location.reload();
                } catch (error) {
                    showStatus('Import failed!', 'error');
                }
            };
            reader.readAsText(file);
        }

        function clearAllData() {
            if (confirm('Delete all data? This cannot be undone!')) {
                localStorage.removeItem('quoteflow_data');
                location.reload();
            }
        }

        // Auto-save on input
        function setupAutoSave() {
            document.addEventListener('input', () => {
                clearTimeout(window.saveTimeout);
                window.saveTimeout = setTimeout(saveData, 1000);
            });

            document.addEventListener('change', () => {
                clearTimeout(window.saveTimeout);
                window.saveTimeout = setTimeout(saveData, 500);
            });
        }

        // Initialize App
        function initApp() {
            // Set default dates
            const today = new Date().toISOString().split('T')[0];
            const futureDate = new Date();
            futureDate.setDate(futureDate.getDate() + 30);
            
            document.getElementById('quotationDate').value = today;
            document.getElementById('validUntil').value = futureDate.toISOString().split('T')[0];
            
            // Load saved data
            loadData();
            
            // Setup auto-save
            setupAutoSave();
            
            // Switch to saved page
            if (AppState.currentPage) {
                switchPage(AppState.currentPage);
            }
            
            // Setup event listeners for calculations
            document.addEventListener('input', (e) => {
                if (e.target.matches('.item-quantity, .item-price, #taxRate')) {
                    if (e.target.matches('.item-quantity, .item-price')) {
                        const lineItem = e.target.closest('.line-item');
                        updateLineItemTotal(lineItem);
                    } else {
                        updateGrandTotal();
                    }
                }
            });
            
            console.log('QuoteFlow initialized successfully!');
            showStatus('Welcome to QuoteFlow!');
        }

        // Start the app
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Save data before page unload
        window.addEventListener('beforeunload', saveData);
    </script>
</body>
</html>
